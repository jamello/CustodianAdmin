ALTER PROCEDURE [ABSSP_ADMIN_EQUIP_REPAIRS]
	(@RPT_ST_DATE	DATETIME 
	,@RPT_END_DATE	DATETIME 
	,@RPT_ST_BRANCH	CHAR(5)
	,@RPT_END_BRANCH CHAR(5)
	,@RPT_ST_TYPE	CHAR(5) 
	,@RPT_END_TYPE CHAR(5) )

AS

  SELECT 
     WK.ADM_REPAIRS_TYPE AS RPT_REPAIRS_TYPE
     ,WK.ADM_REPAIRS_TRANS_NO AS RPT_REPAIRS_TRANS_NO
    ,WK.ADM_REPAIRS_TRANS_DATE AS RPT_DATE
    ,WK.ADM_REPAIRS_BRANCH_CODE AS RPT_BRANCH_CODE
    ,WK.ADM_REPAIRS_DEPT_CODE AS RPT_DEPT_CODE
    ,WK.ADM_REPAIRS_TRANS_AMT AS RPT_TRANS_AMT
    ,WK.ADM_REPAIRS_TRANS_DESC AS RPT_EQUIP_DESC
    ,WK.ADM_REPAIRS_SERVICE_COY AS RPT_SERVICE_COY
    ,WK.ADM_REPAIRS_SERVICE_HRS AS RPT_SERVICE_HRS
    ,(SELECT CTBRA_NAME FROM [ABSBRNCHTAB] WHERE CTBRA_NUM = WK.ADM_REPAIRS_BRANCH_CODE)AS RPT_BRANCH_NAME
    ,(SELECT CTINSRD_LONG_DESCR FROM ABSDEPTTAB WHERE CTINSRD_NO = wk.ADM_REPAIRS_DEPT_CODE) AS RPT_DEPT_NAME
    , (SELECT ADM_TAB_ITEM_DESC FROM ADM_MAINT_CODE_TABLE WHERE ADM_TAB_ITEM_CODE_NO = ADM_REPAIRS_TYPE  AND ADM_TAB_CLASS_CODE = '003') AS RPT_EQUIP_TYPE
    , (SELECT ADM_TAB_ITEM_DESC FROM ADM_MAINT_CODE_TABLE WHERE ADM_TAB_ITEM_CODE_NO = ADM_REPAIRS_SERVICE_COY  AND ADM_TAB_CLASS_CODE = '002') AS RPT_SERVICE_COY_NAME
    FROM ADM_REPAIRS_BILLS  AS WK

    --LEFT JOIN [ADM_MAINT_CODE_TABLE]  AS EQUIP
    --   ON (EQUIP.ADM_TAB_ITEM_CODE_NO = WK.ADM_REPAIRS_TYPE AND EQUIP.ADM_TAB_CLASS_CODE = '003')
    --LEFT JOIN [ADM_MAINT_CODE_TABLE]  AS INS
    --   ON (INS.ADM_TAB_ITEM_CODE_NO = WK.ADM_REPAIRS_SERVICE_COY AND INS.ADM_TAB_CLASS_CODE = '002')

 --WHERE WK.ADM_REPAIRS_TRANS_DATE >= @RPT_ST_DATE AND WK.ADM_REPAIRS_TRANS_DATE <= @RPT_END_DATE AND
 --WK.ADM_REPAIRS_TYPE >= @RPT_ST_TYPE AND WK.ADM_REPAIRS_TYPE <= @RPT_END_TYPE AND
 --WK.ADM_REPAIRS_BRANCH_CODE >= @RPT_ST_BRANCH AND WK.ADM_REPAIRS_BRANCH_CODE <= @RPT_END_BRANCH

    ORDER BY WK.ADM_REPAIRS_BRANCH_CODE,WK.ADM_REPAIRS_TYPE, WK.ADM_REPAIRS_TRANS_DATE
 

GO
SET QUOTED_IDENTIFIER OFF 
GO
SET ANSI_NULLS ON 
GO
